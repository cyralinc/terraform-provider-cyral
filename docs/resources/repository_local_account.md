# cyral_repository_local_account (Resource)

Manages [repository local accounts](https://cyral.com/docs/using-cyral/sso-auth-users#give-your-sidecar-access-to-the-local-account).

-> **NOTE** Import ID syntax is `{repository_id}/{local_account_id}`, where `{local_account_id}` is the ID of the local account in the Cyral Control Plane.

## Example Usage

### Automatic Approval

```terraform
### AWS Secrets Manager with automatic approval
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    config {
        auto_approve_access = true
        # Automatically approve 5 minutes access requests
        max_auto_approve_duration = "PT5M"
    }
    aws_secrets_manager {
        database_name = ""
        local_account = ""
        secret_arn = ""
    }
}
```

### Different auth schemes

```terraform
### AWS IAM
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    aws_iam {
        database_name = ""
        local_account = ""
        role_arn = ""
    }
}

### AWS Secrets Manager
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    aws_secrets_manager {
        database_name = ""
        local_account = ""
        secret_arn = ""
    }
}

### Cyral Storage
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    cyral_storage {
        database_name = ""
        local_account = ""
        password = ""
    }
}

### Hashicorp Vault
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    hashicorp_vault {
        database_name = ""
        local_account = ""
        path = ""
    }
}

### Environment variable
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    environment_variable {
        local_account = ""
        variable_name = ""
    }
}

### Kubernetes Secret
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    kubernetes_secret {
        local_account = ""
        secret_name   = ""
        secret_key    = ""
    }
}

### GCP Secret Manager
resource "cyral_repository_local_account" "some_resource_name" {
    repository_id = cyral_repository.SOME_REPOSITORY_RESOURCE_NAME.id
    gcp_secret_manager {
        database_name = ""
        local_account = ""
        secret_name = ""
    }
}
```

<!-- schema generated by tfplugindocs -->

## Schema

### Required

- `repository_id` (String) ID of the repository that will be used by the local account.

### Optional

- `aws_iam` (Block Set, Max: 1) Credential option to set the local account from AWS IAM. (see [below for nested schema](#nestedblock--aws_iam))
- `aws_secrets_manager` (Block Set, Max: 1) Credential option to set the local account from AWS Secrets Manager. (see [below for nested schema](#nestedblock--aws_secrets_manager))
- `config` (Block Set, Max: 1) Optional configuration for automatic approvals. (see [below for nested schema](#nestedblock--config))
- `cyral_storage` (Block Set, Max: 1) Credential option to set the local account from Cyral Storage. (see [below for nested schema](#nestedblock--cyral_storage))
- `enviroment_variable` (Block Set, Max: 1, Deprecated) Credential option to set the local account from Environment Variable. (see [below for nested schema](#nestedblock--enviroment_variable))
- `environment_variable` (Block Set, Max: 1) Credential option to set the local account from Environment Variable. (see [below for nested schema](#nestedblock--environment_variable))
- `gcp_secret_manager` (Block Set, Max: 1) Credential option to set the local account from GCP Secret Manager. (see [below for nested schema](#nestedblock--gcp_secret_manager))
- `hashicorp_vault` (Block Set, Max: 1) Credential option to set the local account from Hashicorp Vault. (see [below for nested schema](#nestedblock--hashicorp_vault))
- `kubernetes_secret` (Block Set, Max: 1) Credential option to set the local account from Kubernetes Secret. (see [below for nested schema](#nestedblock--kubernetes_secret))

### Read-Only

- `id` (String) ID of this resource in Cyral environment.

<a id="nestedblock--aws_iam"></a>

### Nested Schema for `aws_iam`

Required:

- `local_account` (String) Local account name.
- `role_arn` (String) AWS IAM role ARN.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--aws_secrets_manager"></a>

### Nested Schema for `aws_secrets_manager`

Required:

- `local_account` (String) Local account name.
- `secret_arn` (String) ARN of the AWS Secret Manager that stores the credential.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--config"></a>

### Nested Schema for `config`

Required:

- `auto_approve_access` (Boolean) If true, enables automatic approvals for this local account.

Optional:

- `max_auto_approve_duration` (String) Maximum duration (in seconds) for which approvals can be automatically granted, following ISO 8601 time format. For example, "PT1H2M3S" indicates 1 hour, 2 minutes and 3 seconds. "PT4S" denotes 4 seconds.

<a id="nestedblock--cyral_storage"></a>

### Nested Schema for `cyral_storage`

Required:

- `local_account` (String) Local account name.
- `password` (String, Sensitive) Local account password.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--enviroment_variable"></a>

### Nested Schema for `enviroment_variable`

Required:

- `local_account` (String) Local account name.
- `variable_name` (String) Name of the environment variable that will store credentials.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--environment_variable"></a>

### Nested Schema for `environment_variable`

Required:

- `local_account` (String) Local account name.
- `variable_name` (String) Name of the environment variable that will store credentials.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--gcp_secret_manager"></a>

### Nested Schema for `gcp_secret_manager`

Required:

- `local_account` (String) Local account name.
- `secret_name` (String) The unique identifier of the secret in GCP Secret Manager. Should obey one of the following formats: `projects/<project-name>/secrets/<secret-name>` or `projects/<project-name>/secrets/<secret-name>/versions/<version>`.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--hashicorp_vault"></a>

### Nested Schema for `hashicorp_vault`

Required:

- `local_account` (String) Local account name.
- `path` (String) Hashicorp Vault path.

Optional:

- `database_name` (String) Database name that the local account corresponds to.

<a id="nestedblock--kubernetes_secret"></a>

### Nested Schema for `kubernetes_secret`

Required:

- `local_account` (String) Local account name.
- `secret_key` (String) Name of the key that stores the credentials within the secret.
- `secret_name` (String) Name of the secret in kubernetes.

Optional:

- `database_name` (String) Database name that the local account corresponds to.
